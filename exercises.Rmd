# Tutoriel 6 Exercices

## Setup

Pour commencer, nous devrons charger les packages et les données que nous utiliserons dans cette session. Il existe de nombreux nouveaux packages à utiliser, alors assurez-vous de les installer avant de continuer!

```{r}
#vous devriez déjà les avoir!
library(dplyr)
library(ggplot2)
library(janitor)

#Ceux-ci sont probablement nouveaux
library(lmerTest)
library(multcomp)
library(multcompView)
library(emmeans)
library(MuMIn)
library(agridat)


```


## Exercice 1

Nous allons commencer par un exemple provenant d'un jeu de données qui est importe dans R avec le package `agridat`.

Avec les jeux de données qui sont intégrés dans des packages R, la première fois que nous voulons les utiliser, nous les désignons par leur nom en utilisant la fonction `data`. Vous verrez que cela cree un objet que nous pouvons alors voir dans notre fenetre d'environnement de RStudio.

Ce jeu de données est issu d'une expérience visant a comparer les rendements de 8 variétés d'orge.

Exécutez le code ci-dessous pour importer ces données et voir la structure. Chaque variété est repetee 20 fois dans cette expérience sur le même champ. La disposition en grille du champ est capturée par les variables 'row' et 'column', les différentes variétés d'orge sont indiques dans la colonne 'gen' et les rendements sont dans la colonne 'yield'

```{r}
data(beaven.barley)
beaven.barley
```
Pour commencer, supposons que nos observations sont indépendantes. Elles sont toutes sur le même terrain après tout !

*Question 1: Créez un graphique en boîte à moustaches montrant les rendements pour chaque génotype en utilisant `ggplot`. Interprétez ce que l'on y voit *

```{r}



```
*Question 2: Calculez la moyenne et les écarts types du rendement par génotype en utilisant `group_by` et `summarise`* 

```{r}

```

*Question 3: Ajuster un modèle ANOVA de rendement par génotype en utilisant la fonction `lm`. Stockez-le comme un objet appelé `barley1`*

```{r}
barley1<-lm()
```

*Question 4: Utilisez les fonctions 'summary()' et 'anova()' sur le modèle pour fournir des informations sur l'ajustement de notre modele. Qu'est-ce que vous voyez ?*

```{r}

```

*Question 5: Utilisez la fonction plot pour vérifier les conditions de validite de notre ajustement. Est-ce que quelque chose semble problématique?*

```{r}

```

*Question 6: Utilisez la fonction emmeans() pour obtenir les moyennes estimées et les intervalles de confiance pour chaque génotype. Puis utilisez la fonction cld() pour effectuer l'analyse de 'mean separation'*

```{r}

```


## Exercice 2

Dans l'exercice 1, nous avons supposé que tous les points étaient indépendants et que les facteurs de disposition de nos parcelles dans le champ n'étaient pas pertinents. Examinons cela plus en détail.

*Question 1: En utilisant la fonction `tabyl`, produisez deux tableaux pour montrer combien de fois chaque génotype apparaît dans chaque ligne (tableau 1) et chaque colonne (tableau 2) *

```{r}
#Table 1
beaven.barley %>%
  tabyl()

#Table 2
beaven.barley %>%
  tabyl()


```

Vous devriez voir que chaque génotype apparaît 4 fois par ligne. Tous les génotypes n'apparaissent pas dans toutes les colonnes, mais il y a clairement un effort de faire un design équilibré.

*Question 2: Faites deux graphiques en boîtes à moustaches (boxplot) montrant les distributions de rendement dans chaque ligne (1) puis dans chaque colonne (2). Que remarquez-vous? *
Astuce - le message d'avertissement que vous pouvez voir essaie de vous aider! Faites attention à ce qu'il dit.

```{r}
#Plot 1

```

```{r}
#Plot 2
```


*Question 3: Ajustez maintenant un modèle en utilisant lmer() et sauvez le resultat dans un objet appelé barley2. Les effets aléatoires pour cette disposition en lignes et colonnes doivent être spécifiés dans notre modele. VOus devez donc indiquer la variable 'row' comme effet aleatoire et la variable 'column' comme un autre  effet aléatoire. Ainsi, la partie aléatoire de votre formule pour le modèle devrait ressembler à "(1|row)+(1|col)"*


```{r}
barley2<-lmer(????????+(1|row)+(1|col),??????)
```

*Question 4: Utilisez les fonctions summary(), anova(), plot() et aussi le r.squaredGLMM() pour étudier ce modèle et comparez-le aux résultats de l'exercice 1. Que remarquez-vous? Pouvez-vous expliquer les différences?*

```{r}

```



*Question 5: Effectuez l'analyse 'mean separation' sur le nouveau modèle, pour obtenir les moyennes ajustées, les intervalles de confiance et l'affichage des lettres. Comparez à nouveau avec les résultats de l'exercice 1 - que remarquez-vous?* 
```{r}

```



